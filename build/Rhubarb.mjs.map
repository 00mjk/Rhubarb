{"version":3,"file":"Rhubarb.mjs","sources":["../js/ReusableBufferCache.js","../js/CharByteMap.js","../js/Protocol.js","../js/ProtocolParser.js","../js/index.js"],"sourcesContent":["var ReusableBufferCache = function(){\n  this.cache = new Object();\n}\n\nReusableBufferCache.prototype.notify = function(len){\n  if (!this.cache[len]){\n    var float32 = new Float32Array(len);\n    var uint8 = new Uint8Array(float32.buffer);\n    this.cache[len] = {\n      uint8: uint8,\n      float32: float32\n    };\n  }\n}\n\nReusableBufferCache.prototype.get = function(strLength){\n  var elem = this.cache[strLength];\n  if (!elem){\n    throw new Error(\"ReusableBufferCache is empty.\");\n  }\n  return elem;\n}\n\nexport default new ReusableBufferCache();\n","var supportedChars = [\n  \"!\", \"\\\"\", \"#\", \"$\", \"%\", \"&\", \"\\'\", \"(\", \")\", \"*\", \"+\", \",\", \"-\", \".\", \"/\",\n  \"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \":\", \";\", \"<\", \"=\", \">\", \"?\",\n  \"@\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\",\n  \"P\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\", \"[\", \"\\\\\", \"]\", \"^\", \"_\", \"`\",\n  \"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\", \"j\", \"k\", \"l\", \"m\", \"n\", \"o\", \"p\",\n  \"r\", \"s\", \"t\", \"u\", \"v\", \"w\", \"x\", \"y\", \"z\", \"{\", \"|\", \"}\", \"~\", \"q\", \"Q\"\n];\n\nvar charByteMap = new Object();\nvar byteCharMap = new Object();\nfor (var i = 0; i<supportedChars.length; i++){\n  charByteMap[supportedChars[i]] = (i+1);\n  byteCharMap[(i+1)] = supportedChars[i];\n}\n\nexport {charByteMap, byteCharMap};\n","import ReusableBufferCache from \"./ReusableBufferCache\";\nimport {charByteMap, byteCharMap} from \"./CharByteMap\";\n\n\nvar Protocol = function(name){\n  this.name = name;\n  this.parameters = new Object();\n  this.parameterIDsByParameterName = new Object();\n  this.parameterBufferIndicesByParameterName = new Object();\n}\n\nProtocol.prototype.MAX_STRING_PARAMETER_LENGTH = 100;\n\nProtocol.prototype.typeNumerical = {isNumerical: true, requiredBufferLen: 2};\n\nProtocol.prototype.getCharByte = function(char){\n  return charByteMap[char] || 0;\n}\n\nProtocol.prototype.getParameterFromBuffer = function(parameterName){\n  var parameter = this.parameters[parameterName];\n  if (!parameter){\n    throw new Error(\"No such parameter: \"+parameterName+\" in protocol: \"+this.name);\n  }\n  var startIndex = this.parameterBufferIndicesByParameterName[parameterName];\n  if (parameter.isNumerical){\n    return this.buffer[startIndex + 1];\n  }\n  var computationBuffers = ReusableBufferCache.get(parameter.requiredBufferLen);\n  var float32 = computationBuffers.float32;\n  for (var i = 0; i<parameter.requiredBufferLen; i++){\n    float32[i] = this.buffer[startIndex + 1 + i];\n  }\n  var uint8 = computationBuffers.uint8;\n  var value = \"\";\n  for (var i = 0; i<uint8.length; i++){\n    if (uint8[i] == 0){\n      break;\n    }\n    value += byteCharMap[uint8[i]];\n  }\n  return value;\n}\n\nProtocol.prototype.setParameterToBuffer = function(parameterName, value){\n  var parameter = this.parameters[parameterName];\n  if (!parameter){\n    throw new Error(\"No such parameter: \"+parameterName+\" in protocol: \"+this.name);\n  }\n  var startIndex = this.parameterBufferIndicesByParameterName[parameterName];\n  var parameterID = this.parameterIDsByParameterName[parameterName];\n  this.buffer[startIndex] = parameterID;\n  if (parameter.isNumerical){\n    this.buffer[startIndex + 1] = value;\n  }else{\n    if (value.length > parameter.maxLength){\n      throw new Error(\"Parameter overflow: \"+parameterName+\" in protocol \"+this.name);\n    }\n    var computationBuffers = ReusableBufferCache.get(parameter.requiredBufferLen);\n    var uint8 = computationBuffers.uint8;\n    for (var i = 0; i<uint8.length; i++){\n      if (i < value.length){\n        uint8[i] = this.getCharByte(value[i]);\n      }else{\n        uint8[i] = 0;\n      }\n    }\n    var float32 = computationBuffers.float32;\n    var curIndex = startIndex + 1;\n    for (var i = 0; i<float32.length; i++){\n      this.buffer[curIndex ++] = float32[i];\n    }\n  }\n}\n\nProtocol.prototype.addNumericalParameter = function(parameterName){\n  this.parameters[parameterName] = this.typeNumerical;\n}\n\nProtocol.prototype.addStringParameter = function(parameterName, maxLength){\n  if (maxLength > this.MAX_STRING_PARAMETER_LENGTH){\n    throw new Error(\"Parameter size exceeds max allowed string parameter size \"+this.MAX_STRING_PARAMETER_LENGTH);\n  }\n  this.parameters[parameterName] = {\n    isNumerical: false, maxLength: maxLength, requiredBufferLen: (Math.ceil(maxLength / 4) + 1)\n  };\n}\n\nProtocol.prototype.init = function(){\n  var requiredBufferLen = 0;\n  var curParameterID = 0;\n  for (var parameterName in this.parameters){\n    this.parameterIDsByParameterName[parameterName] = curParameterID ++;\n    this.parameterBufferIndicesByParameterName[parameterName] = requiredBufferLen;\n    var parameter = this.parameters[parameterName];\n    requiredBufferLen += parameter.requiredBufferLen;\n    if (!parameter.isNumerical){\n      ReusableBufferCache.notify(requiredBufferLen);\n    }\n  }\n  this.buffer = new Float32Array(requiredBufferLen);\n}\n\nexport default Protocol;\n","import Protocol from \"./Protocol\";\n\nvar ProtocolParser = function(){\n  this.NUMERICAL_TYPE = \"numerical\";\n  this.CHARACTER_TYPE = \"char\";\n}\n\nProtocolParser.prototype.parseCharacterType = function(characterType){\n  var splitted = characterType.split(\"_\");\n  if (splitted[0] == this.CHARACTER_TYPE){\n    if (!splitted[1]){\n      return false;\n    }\n    return parseInt(splitted[1]);\n  }\n  return false;\n}\nProtocolParser.prototype.parseProtocol = function(protocolInfo, protocolName){\n  var protocol = new Protocol(protocolName);\n  for (var parameterName in protocolInfo){\n    var parameterType = protocolInfo[parameterName];\n    if (parameterType == this.NUMERICAL_TYPE){\n      protocol.addNumericalParameter(parameterName);\n    }else if (parameterType.startsWith(this.CHARACTER_TYPE)){\n      var maxLength = this.parseCharacterType(parameterType);\n      if (!maxLength){\n        throw new Error(\"Char types must be in format char_N, where N is the char length.\")\n      }\n      protocol.addStringParameter(parameterName, maxLength);\n    }else{\n      throw new Error(\"Invalid parameter type.\");\n    }\n  }\n  protocol.init();\n  return protocol;\n}\n\nProtocolParser.prototype.parse = function(jsonData){\n  var parsedProtocols = new Object();\n  for (var protocolName in jsonData){\n    var protocolInfo = jsonData[protocolName];\n    var protocol = this.parseProtocol(protocolInfo, protocolName);\n    parsedProtocols[protocol.name] = protocol;\n  }\n  return parsedProtocols;\n}\n\nexport default new ProtocolParser();\n","import ProtocolParser from \"./ProtocolParser\";\n\nvar Rhubarb = function(){\n  this.IS_NODE = (typeof window == \"undefined\");\n}\n\nRhubarb.prototype.initNode = function(protocolDefinitionPath){\n  var fs = require('fs');\n  if (!fs.existsSync(protocolDefinitionPath)){\n    throw new Error(\"Protocol definition file does not exist.\");\n  }\n  var content = fs.readFileSync(protocolDefinitionPath, \"utf8\");\n  var parsedJSON;\n  try{\n    parsedJSON = JSON.parse(content);\n  }catch(err){\n    throw new Error(\"Protocol definition file is not a valid JSON: \" + err);\n  }\n  var protocols = ProtocolParser.parse(parsedJSON);\n  for (var key in protocols){\n    this.protocols[key] = protocols[key];\n  }\n  console.log(this.protocols);\n}\n\nRhubarb.prototype.init = function(protocolDefinitionPath){\n  this.protocols = new Object();\n  if (this.IS_NODE){\n    this.initNode(protocolDefinitionPath);\n    return;\n  }\n  var xhttpRequest = new XMLHttpRequest();\n  xhttpRequest.overrideMimeType(\"application/json\");\n  xhttpRequest.open(\"GET\", protocolDefinitionPath, true);\n  xhttpRequest.onreadystatechange = function(){\n    if (xhttpRequest.readyState == 4 && xhttpRequest.status == \"200\"){\n      var parsedJSON;\n      try{\n        parsedJSON = JSON.parse(xhttpRequest.responseText);\n      }catch(err){\n        throw new Error(\"Protocol definition file is not a valid JSON: \" + err);\n      }\n      var protocols = ProtocolParser.parse(parsedJSON);\n      for (var key in protocols){\n        this.protocols[key] = protocols[key];\n      }\n    }else if (xhttpRequest.readyState == 4){\n      throw new Error(\"Protocol definition file not found.\");\n    }\n  }.bind({protocols: this.protocols});\n  xhttpRequest.send(null);\n}\n\nexport default new Rhubarb();\n"],"names":["ReusableBufferCache","cache","Object","prototype","notify","len","float32","Float32Array","uint8","Uint8Array","buffer","get","strLength","elem","Error","supportedChars","charByteMap","byteCharMap","i","length","Protocol","name","parameters","parameterIDsByParameterName","parameterBufferIndicesByParameterName","MAX_STRING_PARAMETER_LENGTH","typeNumerical","isNumerical","requiredBufferLen","getCharByte","char","getParameterFromBuffer","parameterName","parameter","startIndex","computationBuffers","value","setParameterToBuffer","parameterID","maxLength","curIndex","addNumericalParameter","addStringParameter","Math","ceil","init","curParameterID","ProtocolParser","NUMERICAL_TYPE","CHARACTER_TYPE","parseCharacterType","characterType","splitted","split","parseInt","parseProtocol","protocolInfo","protocolName","protocol","parameterType","startsWith","parse","jsonData","parsedProtocols","Rhubarb","IS_NODE","window","initNode","protocolDefinitionPath","fs","require","existsSync","content","readFileSync","parsedJSON","JSON","err","protocols","key","log","xhttpRequest","XMLHttpRequest","overrideMimeType","open","onreadystatechange","readyState","status","responseText","bind","send"],"mappings":"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"}